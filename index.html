<!doctype html>
<html ng-app>
<head>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.0.8/angular.min.js"></script>
</head>
<body ng-controller="Ctrl">
<script src="http://192.168.102.66:8080/socket.io/socket.io.js"></script>
<script src="chatConnector.js"></script>
<script>


  var chat = new ChatConnector("http://192.168.102.66:8080");

  //var username=prompt("Please enter your name:");
  var username = "Team F";
  chat.login(username);

</script>
<script>

function Ctrl($scope) {
  chat.handleAllRooms(function (rooms){
  	console.log("all the rooms");
  	console.log(rooms);
        $scope.$apply(function () {
          $scope.rooms = rooms;
        });
  });

  chat.handleJoinedRooms(function (rooms){
    console.log("joined rooms");
    console.log(rooms);
  });

  chat.handleUsersInRoom(function (roomUsers){
    console.log("users in room");
  	console.log(roomUsers);
  });
  chat.handleReceiveMessage(function (message){
  	console.log("received message");
  	console.log(message);
  });
  
  $scope.listRooms = function() {
    listoutput = ''
    angular.forEach($scope.rooms, function(room) {
        listoutput += room + '<br>';
      });
    console.log("hey ho let's go");
    return listoutput;
    
  };
}
</script>
<div>
  <label>Rooms</label>
  <h3>Rooms: {{rooms}}</h3>
  <div id='roomslist'></div>
  <div ng-bind-html-unsafe="listRooms()"></div>
</div>
</body>
</html>
