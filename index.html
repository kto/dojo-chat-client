<!doctype html>
<html ng-app>
<head>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.0.8/angular.min.js"></script>
</head>
<body ng-controller="Ctrl">
<script src="http://192.168.102.66:8080/socket.io/socket.io.js"></script>
<script src="chatConnector.js"></script>
<script>


  var chat = new ChatConnector("http://192.168.102.66:8080");

  //var username=prompt("Please enter your name:");
  var username = "Team F" + Math.floor((Math.random()*16386)+1);;
  chat.login(username);

</script>
<script>

function Ctrl($scope) {
  chat.handleAllRooms(function (rooms){
  	console.log("all the rooms");
  	console.log(rooms);
        $scope.$apply(function () {
          $scope.rooms = rooms;
        });
  });

  chat.handleJoinedRooms(function (rooms){
    console.log("joined rooms");
    console.log(rooms);
  });

  chat.handleUsersInRoom(function (roomUsers){
    console.log("users in room");
  	console.log(roomUsers);
  });
  chat.handleReceiveMessage(function (message){
  	console.log("received message");
  	console.log(message);
  });
  
  $scope.joinRoom = function(room) {
    console.log('joinRoom:' + room);
    chat.joinRoom(room);
  };

}
</script>

<h3>Rooms: {{rooms}}</h3>
<ul>
  <li ng-repeat="room in rooms">
    <a style="cursor:pointer; color: blue;" ng-click="joinRoom(room)"><u>{{room}}</u></a>
  </li>
</ul>

</body>
</html>
